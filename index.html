<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>AR Viewer</title>

<!-- Google Analytics GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-63KRRF9EPX"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-63KRRF9EPX');
</script>

<style>
body{
  margin:0;
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  text-align:center;
}

button{
  padding:15px 25px;
  margin:10px;
  font-size:18px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
</style>
</head>
<body>

<div id="menu">
  <h2>モデルを選択してください</h2>
  <button onclick="launchAR('A')">Aモデル</button>
  <button onclick="launchAR('B')">Bモデル</button>
  <button onclick="launchAR('C')">Cモデル</button>
</div>

<div id="loading" style="display:none;">
  <h2>3Dモデルを読み込み中...</h2>
</div>

<script>

// ===== モデルURL定義 =====
const models = {
  A: {
    ios: "https://seiryolabo03.github.io/Seiryolabo2026automaticOSdetection/graduationARmodel.usdz",
    android: "https://seiryolabo03.github.io/Seiryolabo2026automaticOSdetection/graduationARmodel.glb"
  },
  B: {
    ios: "https://seiryolabo03.github.io/Seiryolabo2026automaticOSdetection/graduationARsmall.usdz",
    android: "https://seiryolabo03.github.io/Seiryolabo2026automaticOSdetection/graduationARsmall.glb"
  }
};

// ===== 端末判定 =====
const ua = navigator.userAgent;
const isIOS =
  /iPhone|iPad|iPod/i.test(ua) ||
  (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
const isAndroid = /Android/i.test(ua);

// ===== AR起動関数 =====
function launchAR(model){

  if(!models[model]) return;

  // Analytics送信
  gtag('event', 'model_selected', {
    model_name: model,
    device: isIOS ? "iOS" : isAndroid ? "Android" : "Other"
  });

  // UI切り替え
  document.getElementById("menu").style.display = "none";
  document.getElementById("loading").style.display = "block";

  setTimeout(() => {

    if(isIOS){
      window.location.href = models[model].ios;
    }

    if(isAndroid){
      const sceneUrl =
        "intent://arvr.google.com/scene-viewer/1.0?file=" +
        encodeURIComponent(models[model].android) +
        "&mode=ar_only&resizable=false" +
        "#Intent;scheme=https;package=com.google.android.googlequicksearchbox;end;";
      window.location.href = sceneUrl;
    }

  }, 300);
}

</script>

</body>
</html>
